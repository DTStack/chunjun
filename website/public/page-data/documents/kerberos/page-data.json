{"componentChunkName":"component---src-pages-documents-markdown-remark-parent-file-name-js","path":"/documents/kerberos/","result":{"data":{"markdownRemark":{"html":"<h1>数据源开启Kerberos安全认证</h1>\n<p>目前ChunJun的部分插件支持了kerberos认证，有Hive、Hbase、HDFS三个插件。</p>\n<h3>1.Kerberos证书加载方式</h3>\n<p>目前支持两种方式，一种是从本地加载，即任务运行的机器上对应的目录必须存在配置里指定的证书文件，另一种是从sftp服务器下载，需要配置sftp服务器的配置信息。</p>\n<p>使用本地配置示例：</p>\n<pre><code class=\"language-json\">\"hbaseConfig\": {\r\n \"hbase.zookeeper.property.clientPort\": \"2181\",\r\n \"hbase.rootdir\": \"hdfs://ns1/hbase\",\r\n \"hbase.cluster.distributed\": \"true\",\r\n \"hbase.zookeeper.quorum\": \"host1,host2,host3\",\r\n \"zookeeper.znode.parent\": \"/hbase\",\r\n \"hbase.security.authentication\":\"Kerberos\",\r\n \"hbase.security.authorization\":true,\r\n \"hbase.master.kerberos.principal\":\"hbase/node1@TEST.COM\",\r\n \"hbase.master.keytab.file\":\"hbase.keytab\",\r\n \"hbase.regionserver.keytab.file\":\"hbase.keytab\",\r\n \"hbase.regionserver.kerberos.principal\":\"hbase/node1@TEST.COM\",\r\n \"java.security.krb5.conf\":\"krb5.conf\",\r\n \"useLocalFile\":true\r\n }\n</code></pre>\n<p>从sftp下载配置示例：</p>\n<pre><code class=\"language-json\">\"hbaseConfig\": {\r\n \"hbase.zookeeper.property.clientPort\": \"2181\",\r\n \"hbase.rootdir\": \"hdfs://ns1/hbase\",\r\n \"hbase.cluster.distributed\": \"true\",\r\n \"hbase.zookeeper.quorum\": \"host1,host2,host3\",\r\n \"zookeeper.znode.parent\": \"/hbase\",\r\n \"hbase.security.authentication\":\"Kerberos\",\r\n \"hbase.security.authorization\":true,\r\n \"hbase.master.kerberos.principal\":\"hbase/node1@TEST.COM\",\r\n \"hbase.master.keytab.file\":\"hbase.keytab\",\r\n \"hbase.regionserver.keytab.file\":\"hbase.keytab\",\r\n \"hbase.regionserver.kerberos.principal\":\"hbase/node1@TEST.COM\",\r\n \"remoteDir\":\"/sftp/chunjun/keytab/hbase\",\r\n \"sftp\":{\r\n     \"host\":\"127.0.0.1\",\r\n     \"port\":\"22\",\r\n     \"username\":\"\",\r\n     \"password\":\"\"\r\n }\r\n }\n</code></pre>\n<p>从sftp下载时的查找顺序：</p>\n<p>1.在/sftp/chunjun/keytab/hbase目录下查找hbase.keytab文件，如果找不到则2</p>\n<p>2.假设任务运行在node1机器上，则在/sftp/chunjun/keytab/hbase/node1下找hbase.keytab文件，找不到则报错;</p>\n<h3>2.各数据源的配置</h3>\n<h4>hbase</h4>\n<pre><code class=\"language-json\">\"hbaseConfig\": {\r\n \"hbase.zookeeper.property.clientPort\": \"2181\",\r\n \"hbase.rootdir\": \"hdfs://ns1/hbase\",\r\n \"hbase.cluster.distributed\": \"true\",\r\n \"hbase.zookeeper.quorum\": \"host1,host2,host3\",\r\n \"zookeeper.znode.parent\": \"/hbase\",\r\n \"hbase.security.authentication\":\"Kerberos\",\r\n \"hbase.security.authorization\":true,\r\n \"hbase.master.kerberos.principal\":\"hbase/node1@TEST.COM\",\r\n \"hbase.master.keytab.file\":\"hbase.keytab\",\r\n \"hbase.regionserver.keytab.file\":\"hbase.keytab\",\r\n \"hbase.regionserver.kerberos.principal\":\"hbase/node1@TEST.COM\",\r\n \"java.security.krb5.conf\":\"krb5.conf\"\r\n }\n</code></pre>\n<h4>hive</h4>\n<pre><code class=\"language-json\">\"hadoopConf\":{\r\n \"dfs.ha.namenodes.ns1\": \"nn1,nn2\",\r\n \"dfs.namenode.rpc-address.ns1.nn2\": \"node03:9000\",\r\n \"dfs.client.failover.proxy.provider.ns1\": \"org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider\",\r\n \"dfs.namenode.rpc-address.ns1.nn1\": \"node02:9000\",\r\n \"dfs.nameservices\": \"ns1\"\r\n \"hadoop.security.authorization\": \"true\",\r\n \"hadoop.security.authentication\": \"Kerberos\",\r\n \"dfs.namenode.kerberos.principal\": \"hdfs/_HOST@HADOOP.COM\",\r\n \"dfs.namenode.keytab.file\": \"hdfs.keytab\",\r\n \"java.security.krb5.conf\": \"krb5.conf\"\r\n}\n</code></pre>\n<p>jdbcUrl格式：jdbc:hive2://127.0.0.1:10000/default;principal=hive/node1@HADOOP.COM</p>\n<h4>hdfs</h4>\n<pre><code class=\"language-json\">\"hadoopConf\":{\r\n    \"dfs.ha.namenodes.ns1\": \"nn1,nn2\",\r\n \"dfs.namenode.rpc-address.ns1.nn2\": \"node03:9000\",\r\n \"dfs.client.failover.proxy.provider.ns1\": \"org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider\",\r\n \"dfs.namenode.rpc-address.ns1.nn1\": \"node02:9000\",\r\n \"dfs.nameservices\": \"ns1\"\r\n    \"hadoop.security.authorization\": \"true\",\r\n    \"hadoop.security.authentication\": \"Kerberos\",\r\n    \"dfs.namenode.kerberos.principal\": \"hdfs/_HOST@HADOOP.COM\",\r\n    \"dfs.namenode.keytab.file\": \"hdfs.keytab\",\r\n    \"java.security.krb5.conf\": \"krb5.conf\"\r\n}\n</code></pre>","id":"c851a301-d02b-5738-be46-86810798cf12","parent":{"id":"398bb1d9-fd1e-59b3-972b-68ef211bace6","name":"kerberos","modifiedTime":"2022-06-07T13:14:12.084Z","ino":3377699721739129}}},"pageContext":{"id":"c851a301-d02b-5738-be46-86810798cf12","parent__name":"kerberos","__params":{"parent__name":"kerberos"}}},"staticQueryHashes":["527733040"]}