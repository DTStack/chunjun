{"componentChunkName":"component---src-pages-documents-markdown-remark-parent-file-name-js","path":"/documents/generalconfig/","result":{"data":{"markdownRemark":{"html":"<h1>插件通用配置</h1>\n<h2>一、Sync</h2>\n<h3>配置文件</h3>\n<p>一个完整的ChunJun任务脚本配置包含 content，setting两个部分。content用于配置任务的输入源、输出源以及数据转换规则，其中包含reader，writer，transformer。setting则配置任务整体的环境设定，其中包含speed，errorLimit，dirty。具体如下所示：</p>\n<pre><code class=\"language-json\">{\r\n  \"job\": {\r\n    \"content\": [\r\n      {\r\n        \"reader\": {},\r\n        \"writer\": {},\r\n        \"transformer\": {}\r\n      }\r\n    ],\r\n    \"setting\": {\r\n      \"speed\": {},\r\n      \"errorLimit\": {},\r\n      \"dirty\": {}\r\n    }\r\n  }\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th></th>\n<th>说明</th>\n<th>是否必填</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>content</td>\n<td>reader</td>\n<td>reader插件详细配置</td>\n<td>是</td>\n</tr>\n<tr>\n<td></td>\n<td>writer</td>\n<td>writer插件详细配置</td>\n<td>是</td>\n</tr>\n<tr>\n<td></td>\n<td>transformer</td>\n<td>数据转换SQL</td>\n<td>否</td>\n</tr>\n<tr>\n<td>setting</td>\n<td>speed</td>\n<td>速率限制</td>\n<td>否</td>\n</tr>\n<tr>\n<td></td>\n<td>errorLimit</td>\n<td>出错控制</td>\n<td>否</td>\n</tr>\n<tr>\n<td></td>\n<td>dirty</td>\n<td>脏数据保存</td>\n<td>否</td>\n</tr>\n</tbody>\n</table>\n<h3>content配置</h3>\n<h4>reader</h4>\n<p>reader用于配置数据的输入源，即数据从何而来。具体配置如下所示：</p>\n<pre><code class=\"language-json\">{\r\n\"reader\" : {\r\n  \"name\" : \"xxreader\",\r\n  \"parameter\" : {},\r\n  \"table\": {\r\n    \"tableName\": \"xxx\"\r\n    }\r\n  }\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>说明</th>\n<th>是否必填</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>name</td>\n<td>reader插件名称，具体名称参考各数据源配置文档</td>\n<td>是</td>\n</tr>\n<tr>\n<td>parameter</td>\n<td>数据源配置参数，具体配置参考各数据源配置文档</td>\n<td>是</td>\n</tr>\n<tr>\n<td>table</td>\n<td>SQL源表名称</td>\n<td>开启transformer后必填</td>\n</tr>\n</tbody>\n</table>\n<h3>writer</h3>\n<p>writer用于配置数据的输出源，即数据写往何处。具体配置如下所示：</p>\n<pre><code class=\"language-json\">{\r\n\"writer\" : {\r\n  \"name\" : \"xxwriter\",\r\n  \"parameter\" : {},\r\n  \"table\": {\r\n    \"tableName\": \"xxx\"\r\n    }\r\n  }\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>说明</th>\n<th>是否必填</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>name</td>\n<td>writer插件名称，具体名称参考各数据源配置文档</td>\n<td>是</td>\n</tr>\n<tr>\n<td>parameter</td>\n<td>数据源配置参数，具体配置参考各数据源配置文档</td>\n<td>是</td>\n</tr>\n<tr>\n<td>table</td>\n<td>SQL结果表名称</td>\n<td>开启transformer后必填</td>\n</tr>\n</tbody>\n</table>\n<h3>transformer配置</h3>\n<p>transformer用于配置数据转换SQL，支持所有Flink原生语法及Function</p>\n<pre><code class=\"language-json\">{\r\n\"transformer\" : {\r\n  \"transformSql\": \"xxx\"\r\n  }\r\n}\n</code></pre>\n<h3>setting配置</h3>\n<h4>speed</h4>\n<p>speed用于配置任务并发数及速率限制。具体配置如下所示：</p>\n<pre><code class=\"language-json\">{\r\n\"speed\" : {\r\n  \"channel\": 1,\r\n  \"readerChannel\": 2,\r\n  \"writerChannel\": 2,\r\n  \"bytes\": 0\r\n}\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>说明</th>\n<th>是否必填</th>\n<th>默认值</th>\n<th>参数类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>channel</td>\n<td>整体任务并行度</td>\n<td>否</td>\n<td>1</td>\n<td>int</td>\n</tr>\n<tr>\n<td>readerChannel</td>\n<td>source并行度</td>\n<td>否</td>\n<td>-1</td>\n<td>int</td>\n</tr>\n<tr>\n<td>writerChannel</td>\n<td>sink并行度</td>\n<td>否</td>\n<td>-1</td>\n<td>int</td>\n</tr>\n<tr>\n<td>bytes</td>\n<td>bytes >0则表示开启任务限速</td>\n<td>否</td>\n<td>0</td>\n<td>Long</td>\n</tr>\n</tbody>\n</table>\n<h4>errorLimit</h4>\n<p>errorLimit用于配置任务运行时数据读取写入的出错控制。具体配置如下所示：</p>\n<pre><code class=\"language-json\">{\r\n\"errorLimit\" : {\r\n  \"record\": 100,\r\n  \"percentage\": 10.0\r\n}\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>说明</th>\n<th>是否必填</th>\n<th>默认值</th>\n<th>参数类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>record</td>\n<td>错误阈值，当错误记录数超过此阈值时任务失败</td>\n<td>否</td>\n<td>0</td>\n<td>int</td>\n</tr>\n<tr>\n<td>percentage</td>\n<td>错误比例阈值，当错误记录比例超过此阈值时任务失败</td>\n<td>否</td>\n<td>0.0</td>\n<td>Double</td>\n</tr>\n</tbody>\n</table>\n<h4></h4>\n<p>metricPluginConf用于配置任务运行时自定义指标持久化的方式。具体配置如下所示：</p>\n<pre><code class=\"language-json\">{\r\n\"metricPluginConf\":{\r\n          \"pluginName\": \"mysql\",\r\n          \"pluginProp\": {\r\n            \"jdbcUrl\": \"jdbc:mysql://localhost:3306/ide?useUnicode=true&#x26;characterEncoding=utf-8\",\r\n            \"schema\": \"ide\",\r\n            \"table\": \"chunjun_metrics\",\r\n            \"username\": \"drpeco\",\r\n            \"password\": \"DT@Stack#123\"\r\n          }\r\n}\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>说明</th>\n<th>是否必填</th>\n<th>默认值</th>\n<th>参数类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>pluginName</td>\n<td>持久化插件的名称</td>\n<td>否</td>\n<td>prometheus</td>\n<td>String</td>\n</tr>\n<tr>\n<td>pluginProp</td>\n<td>连接插件需要用到的参数配置</td>\n<td>否</td>\n<td>无</td>\n<td>Map</td>\n</tr>\n</tbody>\n</table>\n<h4>dirty</h4>\n<p>dirty用于配置脏数据的保存，通常与上文出错控制联合使用。具体配置如下所示：</p>\n<pre><code class=\"language-json\">{\r\n\"dirty\" : {\r\n  \"path\" : \"xxx\",\r\n  \"hadoopConfig\" : {\r\n  }\r\n }\r\n}\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>说明</th>\n<th>是否必填</th>\n<th>默认值</th>\n<th>参数类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>path</td>\n<td>脏数据保存路径</td>\n<td>是</td>\n<td>无</td>\n<td>Sring</td>\n</tr>\n<tr>\n<td>hadoopConfig</td>\n<td>Hadoop相关配置</td>\n<td>是</td>\n<td>无</td>\n<td>K-V键值对</td>\n</tr>\n</tbody>\n</table>\n<p>参考模板如下：</p>\n<pre><code class=\"language-json\">{\r\n\"dirty\" : {\r\n        \"path\" : \"/user/hive/warehouse/xx.db/xx\",\r\n        \"hadoopConfig\" : {\r\n          \"fs.default.name\": \"hdfs://0.0.0.0:9000\",\r\n          \"dfs.ha.namenodes.ns1\" : \"nn1,nn2\",\r\n          \"dfs.namenode.rpc-address.ns1.nn1\" : \"0.0.0.0:9000\",\r\n          \"dfs.namenode.rpc-address.ns1.nn2\" : \"0.0.0.1:9000\",\r\n          \"dfs.client.failover.proxy.provider.ns1\" : \"org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider\",\r\n          \"dfs.nameservices\" : \"ns1\"\r\n        }\r\n  }\r\n}\n</code></pre>\n<h2>二、SQL</h2>\n<p><a href=\"https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/\">参考Flink官方文档</a></p>","id":"15aef91f-91f4-52fa-80ba-00b409909473","parent":{"id":"4b71b2b0-5dda-554c-964a-4ef892388d00","name":"generalconfig","modifiedTime":"2022-06-07T13:14:11.975Z","ino":3377699721739053}}},"pageContext":{"id":"15aef91f-91f4-52fa-80ba-00b409909473","parent__name":"generalconfig","__params":{"parent__name":"generalconfig"}}},"staticQueryHashes":["527733040"]}