{"pageProps":{"content":"\n              <a id=\"断点续传介绍\" style='display: block; height: 35px;'></a>\n              <h1>\n                断点续传介绍\n              </h1>\n            <p>断点续传是为了在离线同步的时候，针对长时间同步任务如超过 1 天，如果在同步过程中由于某些原因导致任务失败，从头再来的话成本非常大，因此需要一个断点续传的功能从任务失败的地方继续。</p>\n\n              <a id=\"原理\" style='display: block; height: 35px;'></a>\n              <h2>\n                原理\n              </h2>\n            <ul>\n<li>基于 flink 的 checkpoint，在 checkpoint 的时候 会存储 source 端最后一条数据的某个字段值，sink 端插件执行事务提交。</li>\n<li>在任务失败，后续通过 checkpoint 重新运行时，source 端在生成 select 语句的时候将 state 里的值作为条件拼接进行数据的过滤，达到从上次失败位点进行恢复</li>\n</ul>\n<p><img src=\"/chunjun/doc/restore/restore1.png\" alt=\"image\"></p>\n<p>jdbcInputFormat 在拼接读取 sql 时，如果从 checkpoint 恢复的 state 不为空且 restoreColumn 不为空，则此时会将 checkpoint 里的 state 作为起点开始读取数据</p>\n\n              <a id=\"适用场景\" style='display: block; height: 35px;'></a>\n              <h1>\n                适用场景\n              </h1>\n            <p>通过上述原理我们可知道 source 端必须是 RDB 类型插件，因为是通过 select 语句拼接 where 条件进行数据过滤达到断点续传的，同时断点续传需要指定一个字段作为过滤条件，且此字段要求是递增的</p>\n<ul>\n<li>任务需要开启 checkpoint</li>\n<li>reader 为 RDB 的插件均支持且 writer 支持事务的插件(如 rdb filesystem 等)，如果下游是幂等性则 writer 插件也不需要支持事务</li>\n<li>作为断点续传的字段在源表里的数据是递增的，因为过滤条件是 &gt;</li>\n</ul>\n\n              <a id=\"参数配置\" style='display: block; height: 35px;'></a>\n              <h2>\n                参数配置\n              </h2>\n            <p>开启 restore 需要在脚本的 restore 里配置相关参数</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>含义</th>\n<th>类型</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>isResore</td>\n<td>是否开启断点续传，true 代表开启断点续传，默认不开启</td>\n<td>boolean</td>\n</tr>\n<tr>\n<td>restoreColumnName</td>\n<td>断点续传字段</td>\n<td>string</td>\n</tr>\n<tr>\n<td>restoreColumnIndex</td>\n<td>断点续传字段在 reader 里的 column 的位置</td>\n<td>int</td>\n</tr>\n</tbody></table>\n\n              <a id=\"示例\" style='display: block; height: 35px;'></a>\n              <h3>\n                示例\n              </h3>\n            <p><img src=\"/chunjun/doc/restore/restore2.png\" alt=\"image\"></p>\n","tree":[{"label":"ChunJun通用配置详解","category":"file"},{"label":"快速开始","category":"file"},{"label":"ChunJun拓展数据格式","children":[{"label":"protobuf-x","path":"protobuf-x","category":"file"}],"category":"dir"},{"label":"ChunJun连接器","children":[{"label":"binlog","category":"dir","children":[{"label":"binlog-source","path":"binlog-source","category":"file"}]},{"label":"clickhouse","category":"dir","children":[{"label":"clickhouse-lookup","path":"clickhouse-lookup","category":"file"},{"label":"clickhouse-sink","path":"clickhouse-sink","category":"file"},{"label":"clickhouse-source","path":"clickhouse-source","category":"file"}]},{"label":"db2","category":"dir","children":[{"label":"db2-lookup","path":"db2-lookup","category":"file"},{"label":"db2-sink","path":"db2-sink","category":"file"},{"label":"db2-source","path":"db2-source","category":"file"}]},{"label":"dm","category":"dir","children":[{"label":"dm-sink","path":"dm-sink","category":"file"},{"label":"dm-source","path":"dm-source","category":"file"}]},{"label":"doris","category":"dir","children":[{"label":"dorisbatch-sink","path":"dorisbatch-sink","category":"file"}]},{"label":"elasticsearch","category":"dir","children":[{"label":"es7-lookup","path":"es7-lookup","category":"file"},{"label":"es7-sink","path":"es7-sink","category":"file"},{"label":"es7-source","path":"es7-source","category":"file"}]},{"label":"gbase","category":"dir","children":[{"label":"gbase-lookup","path":"gbase-lookup","category":"file"},{"label":"gbase-sink","path":"gbase-sink","category":"file"},{"label":"gbase-source","path":"gbase-source","category":"file"}]},{"label":"greenplum","category":"dir","children":[{"label":"greenplum-sink","path":"greenplum-sink","category":"file"},{"label":"greenplum-source","path":"greenplum-source","category":"file"}]},{"label":"hbase","category":"dir","children":[{"label":"hbase-lookup","path":"hbase-lookup","category":"file"},{"label":"hbase-sink","path":"hbase-sink","category":"file"},{"label":"hbase-source","path":"hbase-source","category":"file"}]},{"label":"hdfs","category":"dir","children":[{"label":"hdfs-sink","path":"hdfs-sink","category":"file"},{"label":"hdfs-source","path":"hdfs-source","category":"file"}]},{"label":"hive","category":"dir","children":[{"label":"hive-lookup","path":"hive-lookup","category":"file"},{"label":"hive-sink","path":"hive-sink","category":"file"}]},{"label":"influxdb","category":"dir","children":[{"label":"influxdb-sink","path":"influxdb-sink","category":"file"},{"label":"influxdb-source","path":"influxdb-source","category":"file"}]},{"label":"kafka","category":"dir","children":[{"label":"kafka-sink","path":"kafka-sink","category":"file"},{"label":"kafka-source","path":"kafka-source","category":"file"}]},{"label":"kingbase","category":"dir","children":[{"label":"kingbase-sink","path":"kingbase-sink","category":"file"},{"label":"kingbase-source","path":"kingbase-source","category":"file"}]},{"label":"kudu","category":"dir","children":[{"label":"kudu-lookup","path":"kudu-lookup","category":"file"},{"label":"kudu-sink","path":"kudu-sink","category":"file"},{"label":"kudu-source","path":"kudu-source","category":"file"}]},{"label":"logminer","category":"dir","children":[{"label":"LogMiner-source","path":"LogMiner-source","category":"file"},{"label":"LogMiner原理","path":"LogMiner原理","category":"file"},{"label":"LogMiner配置","path":"LogMiner配置","category":"file"}]},{"label":"mongodb","category":"dir","children":[{"label":"mongodb-lookup","path":"mongodb-lookup","category":"file"},{"label":"mongodb-sink","path":"mongodb-sink","category":"file"},{"label":"mongodb-source","path":"mongodb-source","category":"file"}]},{"label":"mysql","category":"dir","children":[{"label":"mysql-lookup","path":"mysql-lookup","category":"file"},{"label":"mysql-sink","path":"mysql-sink","category":"file"},{"label":"mysql-source","path":"mysql-source","category":"file"}]},{"label":"oracle","category":"dir","children":[{"label":"oracle-lookup","path":"oracle-lookup","category":"file"},{"label":"oracle-sink","path":"oracle-sink","category":"file"},{"label":"oracle-source","path":"oracle-source","category":"file"}]},{"label":"pgwal","category":"dir","children":[{"label":"Postgres-CDC","path":"Postgres-CDC","category":"file"}]},{"label":"postgresql","category":"dir","children":[{"label":"postgres-lookup","path":"postgres-lookup","category":"file"},{"label":"postgres-sink","path":"postgres-sink","category":"file"},{"label":"postgres-source","path":"postgres-source","category":"file"}]},{"label":"rocketmq","category":"dir","children":[{"label":"rocketmq-source","path":"rocketmq-source","category":"file"}]},{"label":"saphana","category":"dir","children":[{"label":"saphana-sink","path":"saphana-sink","category":"file"},{"label":"saphana-source","path":"saphana-source","category":"file"}]},{"label":"sqlserver","category":"dir","children":[{"label":"sqlserver-lookup","path":"sqlserver-lookup","category":"file"},{"label":"sqlserver-sink","path":"sqlserver-sink","category":"file"},{"label":"sqlserver-source","path":"sqlserver-source","category":"file"}]},{"label":"sqlservercdc","category":"dir","children":[{"label":"SqlServer CDC实时采集原理","path":"SqlServer CDC实时采集原理","category":"file"},{"label":"SqlServer配置CDC","path":"SqlServer配置CDC","category":"file"},{"label":"SqlserverCDC-source","path":"SqlserverCDC-source","category":"file"}]}],"category":"dir"},{"label":"开发者指南","children":[{"label":"如何提交一个优秀的PR","path":"如何提交一个优秀的PR","category":"file"},{"label":"如何自定义插件","path":"如何自定义插件","category":"file"}],"category":"dir"},{"label":"拓展功能","children":[{"label":"增量同步介绍","path":"增量同步介绍","category":"file"},{"label":"断点续传介绍","path":"断点续传介绍","category":"file"},{"label":"脏数据插件设计","path":"脏数据插件设计","category":"file"}],"category":"dir"}],"toc":[{"text":"断点续传介绍","level":1,"id":"ac10052f-4c3f-4ec0-aa50-072d690dd95c"},{"text":"原理","level":2,"id":"1f2a2f1a-cddf-4369-9006-f2ace6b7a985"},{"text":"适用场景","level":1,"id":"fddb4a23-eb7d-472a-9afc-940eeba87764"},{"text":"参数配置","level":2,"id":"b26e4fea-62de-4bbd-b79f-17c8d45d0d11"},{"text":"示例","level":3,"id":"fcc72ef9-ef91-47db-9fd6-fa6bde35a1e3"}]},"__N_SSG":true}